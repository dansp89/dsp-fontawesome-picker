(function($){const cdn_base="https://cdn.jsdelivr.net/gh/dansp89/dsp-fontawesome-picker@main";let iconList=null;const defaultTranslations={openPicker:"Open Picker",searchPlaceholder:"Search icons...",noIconsFound:"No icons found"};function loadIconList(){if(iconList){return Promise.resolve()}return fetch(cdn_base+"/v6.json").then(response=>response.json()).then(data=>{iconList=data}).catch(error=>{console.error("Error loading JSON file:",error)})}function addCSS(){if(!document.getElementById("iconpicker-style")){const link=document.createElement("link");link.id="iconpicker-style";link.rel="stylesheet";link.href=cdn_base+"/style.min.css";document.head.appendChild(link)}}addCSS();$.fn.iconPicker=function(options={}){const settings=$.extend({icons:iconList,defaultIcon:null,closeOnSelect:false,closeOnOutsideClick:true,onIconSelect:function(icon){},translate:{}},options);function translate(key){return settings.translate[key]||defaultTranslations[key]||key}const instanceId=`iconpicker-${Math.random().toString(36).substr(2,9)}`;const buttonClose=!settings.closeOnSelect&&!settings.closeOnOutsideClick?'<button class="iconpicker-close-btn" type="button"><i class="fa-classic fa-regular fa-circle-xmark"></i></button>':"";const iconPickerHtml=`<div class="iconpicker-container" id="${instanceId}"><button class="iconpicker-toggle-btn" type="button">${settings.defaultIcon?`<i class="${settings.defaultIcon}"></i>`:translate("openPicker")}</button><div class="iconpicker-card-fa iconpicker-dropdown">${buttonClose}<div class="iconpicker-card-fa-header"><button class="iconpicker-card-fa-controls iconpicker-left" type="button"><i class="fa-solid fa-chevron-left"></i></button><input type="search" class="iconpicker-search-box iconpicker-comp-input-fa" placeholder="${translate("searchPlaceholder")}" /><button class="iconpicker-card-fa-controls iconpicker-right" type="button"><i class="fa-solid fa-chevron-right"></i></button></div><div class="iconpicker-icon-grid"></div><div class="iconpicker-public-class"><input class="iconpicker-comp-fa-class iconpicker-comp-input-fa selected-icon" readonly /></div></div></div>`;this.html(iconPickerHtml);const $container=$(`#${instanceId}`);const $toggleBtn=$container.find(".iconpicker-toggle-btn");const $dropdown=$container.find(".iconpicker-dropdown");const $iconGrid=$container.find(".iconpicker-icon-grid");const $searchBox=$container.find(".iconpicker-search-box");const $selectedIconInput=$container.find(".selected-icon");const $closeBtn=$container.find(".iconpicker-close-btn");const iconsPerPage=25;let currentPage=1;let filteredIcons=[];let selectedIcon=settings.defaultIcon;function renderIcons(page=1){$iconGrid.empty();const start=(page-1)*iconsPerPage;const end=start+iconsPerPage;const iconsToShow=filteredIcons.slice(start,end);if(iconsToShow.length===0){$iconGrid.html(`<p>${translate("noIconsFound")}</p>`);return}iconsToShow.forEach(icon=>{const isSelected=icon===selectedIcon?"selected":"";$iconGrid.append(`<div class="iconpicker-icon-item ${isSelected}" data-icon="${icon}"><i class="${icon}"></i></div>`)})}$searchBox.on("input",function(){const searchValue=$(this).val().toLowerCase();filteredIcons=iconList.filter(icon=>icon.toLowerCase().includes(searchValue));currentPage=1;renderIcons(currentPage)});$iconGrid.on("click",".iconpicker-icon-item",function(){$(".iconpicker-icon-item").removeClass("selected");$(this).addClass("selected");selectedIcon=$(this).data("icon");$selectedIconInput.val(selectedIcon);settings.onIconSelect(selectedIcon);$toggleBtn.html(`<i class="${selectedIcon}"></i>`);if(settings.closeOnSelect){$dropdown.hide()}});$container.find(".iconpicker-left").click(function(){if(currentPage>1){currentPage--;renderIcons(currentPage)}});$container.find(".iconpicker-right").click(function(){const totalPages=Math.ceil(filteredIcons.length/iconsPerPage);if(currentPage<totalPages){currentPage++;renderIcons(currentPage)}});$toggleBtn.click(function(){$dropdown.toggle()});$closeBtn.click(function(){$dropdown.hide()});if(settings.closeOnOutsideClick){$(document).on("click",function(event){if(!$container.is(event.target)&&$container.has(event.target).length===0){$dropdown.hide()}})}loadIconList().then(()=>{filteredIcons=iconList;if(settings.defaultIcon&&iconList.includes(settings.defaultIcon)){selectedIcon=settings.defaultIcon;$selectedIconInput.val(selectedIcon)}renderIcons(currentPage)})}})(jQuery);
